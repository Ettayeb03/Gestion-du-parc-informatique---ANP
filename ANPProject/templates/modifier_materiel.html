{% extends "base.html" %}
{% block content %}
<div class="form-card">
    <div class="form-header">
        <h2><i class="fas fa-edit"></i> Modifier le matériel</h2>
        <a href="{{ url_for('liste_materiels') }}" class="btn btn-outline"><i class="fas fa-arrow-left"></i> Retour</a>
    </div>

    <form method="POST" class="material-form">
        <div class="form-grid-3cols">
            <div class="form-group">
                <label for="nom"><i class="fas fa-tag"></i> Nom</label>
                <input type="text" id="nom" name="nom" value="{{ materiel.nom }}" class="form-control" required>
            </div>

            <div class="form-group">
                <label for="reference"><i class="fas fa-barcode"></i> Référence</label>
                <input type="text" id="reference" name="reference" value="{{ materiel.reference }}" class="form-control" required>
            </div>

            <div class="form-group">
                <label for="numero_serie"><i class="fas fa-hashtag"></i> N° de série</label>
                <input type="text" id="numero_serie" name="numero_serie" value="{{ materiel.numero_serie or '' }}" class="form-control">
            </div>

            <div class="form-group">
                <label for="code_immobilisation"><i class="fas fa-qrcode"></i> Code immobilisation</label>
                <input type="text" id="code_immobilisation" name="code_immobilisation" value="{{ materiel.code_immobilisation or '' }}" class="form-control">
            </div>

            <div class="form-group">
                <label for="type"><i class="fas fa-tools"></i> Type</label>
                <input type="text" id="type" name="type" value="{{ materiel.type }}" class="form-control" required>
            </div>

            <div class="form-group">
                <label for="date_achat"><i class="fas fa-calendar-alt"></i> Date d'achat</label>
                <input type="date" id="date_achat" name="date_achat" value="{{ materiel.date_achat.strftime('%Y-%m-%d') }}" class="form-control" required>
            </div>

            <div class="form-group">
                <label for="etat"><i class="fas fa-heartbeat"></i> État</label>
                <select id="etat" name="etat" class="form-select" required>
                    <option value="fonctionnel" {% if materiel.etat == 'fonctionnel' %}selected{% endif %}>Fonctionnel</option>
                    <option value="en panne" {% if materiel.etat == 'en panne' %}selected{% endif %}>En panne</option>
                    <option value="en maintenance" {% if materiel.etat == 'en maintenance' %}selected{% endif %}>En maintenance</option>
                </select>
            </div>

            <div class="form-group">
                <label for="remarque"><i class="fas fa-comment-alt"></i> Remarque</label>
                <textarea id="remarque" name="remarque" class="form-control" rows="3">{{ materiel.remarque or '' }}</textarea>
            </div>

            <div class="form-group" style="grid-column: span 3;">
                <label for="employe_id"><i class="fas fa-user-tie"></i> Affecté à l'employé</label>
                <select id="employe_id" name="employe_id" class="form-select">
                    <option value="">-- Aucun --</option>
                    {% for e in employes %}
                        <option value="{{ e.id }}" {% if e.id == materiel.employe_id %}selected{% endif %}>{{ e.prenom }} {{ e.nom }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Enregistrer</button>
            <a href="{{ url_for('detail_materiel', materiel_id=materiel.id) }}" class="btn btn-outline"><i class="fas fa-times"></i> Annuler</a>
        </div>
    </form>
</div>

<style>
.form-card {
    background: white;
    border-radius: 0.375rem;
    box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15);
    padding: 1.5rem;
    max-width: 1200px;
    margin: 1rem auto;
}

.form-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    border-bottom: 1px solid #f0f0f0;
    padding-bottom: 0.5rem;
}

.form-header h2 {
    margin: 0;
    font-size: 1.25rem;
    color: #212529;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

/* Grille 3 colonnes */
.form-grid-3cols {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem 1.5rem;
}

.form-group label {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    font-weight: 500;
    margin-bottom: 0.3rem;
    color: #212529;
}

.form-control, .form-select, textarea.form-control {
    width: 100%;
    padding: 0.5rem 0.75rem;
    border: 1px solid #dee2e6;
    border-radius: 0.375rem;
    font-size: 0.9rem;
    transition: all 0.3s ease;
}

.form-control:focus, .form-select:focus, textarea.form-control:focus {
    outline: none;
    border-color: #4361ee;
    box-shadow: 0 0 0 3px rgba(67,97,238,0.15);
}

textarea.form-control {
    min-height: 80px;
    resize: vertical;
}

.form-actions {
    margin-top: 1.5rem;
    display: flex;
    justify-content: flex-end;
    gap: 0.8rem;
}

.btn-primary {
    background-color: #4361ee;
    border-color: #4361ee;
    color: white;
    padding: 0.5rem 1.2rem;
    font-size: 0.95rem;
}

.btn-outline {
    background: transparent;
    border: 1px solid #4361ee;
    color: #4361ee;
    padding: 0.5rem 1.2rem;
    font-size: 0.95rem;
}

.btn-primary:hover {
    background-color: #3a56d4;
    border-color: #3a56d4;
}

.btn-outline:hover {
    background-color: rgba(67, 97, 238, 0.1);
}

@media (max-width: 900px) {
    .form-grid-3cols {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 600px) {
    .form-grid-3cols {
        grid-template-columns: 1fr;
    }
    .form-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.75rem;
    }
    .form-actions {
        justify-content: center;
    }
}
</style>
{% endblock %}
